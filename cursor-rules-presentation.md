# Cursor エディタでプロジェクトルールを定義して開発体験を向上する

## 1. Cursor ルールとは

Cursor ルールは、AI 支援プログラミングをより効果的に活用するための機能です。これにより、プロジェクト固有の知識やコーディング規約を AI に伝え、一貫性のある質の高いコード生成・修正を実現します。

### 主な特徴

- **永続的なコンテキスト**: AI モデルに対して一貫した指示を提供
- **プロジェクト固有の知識**: コードベースの特性やアーキテクチャを定義
- **コーディング規約の統一**: チーム全体で一貫したコーディングスタイルを維持
- **再利用可能**: 複数の会話やセッションで同じルールを活用

## 2. ルールの種類

Cursor では 3 種類のルールをサポートしています：

1. **プロジェクトルール**: `.cursor/rules/`ディレクトリに保存される、プロジェクト固有のルール
2. **ユーザールール**: ユーザー設定で定義される、すべてのプロジェクトに適用されるルール
3. **`.cursorrules`**: レガシー形式（非推奨）

## 3. プロジェクトルールの設定方法

### 3.1 ルールファイルの構造

`.cursor/rules/`ディレクトリに`.mdc`拡張子でファイルを作成します：

```markdown
---
description: "ルールの簡単な説明"
globs: "**/*.py"
alwaysApply: false
---

# ルールのタイトル

ルールの内容をここに記述します...
```

### 3.2 ルールの適用タイプ

Cursor のルール編集 UI には「Rule Type」という明示的な選択肢があり、以下のタイプから選べます：

| 適用タイプ      | UI 表示         | 使用ケース                                     |
| --------------- | --------------- | ---------------------------------------------- |
| Always          | Always          | プロジェクト全体に常に適用するルール           |
| Auto Attached   | Auto Attached   | 特定のファイルタイプやパターンに適用するルール |
| Agent Requested | Agent Requested | AI が必要と判断した場合に適用されるルール      |
| Manual          | Manual          | 明示的に参照する場合のみ適用されるルール       |

### 3.3 メタデータと内部表現

UI で選択した Rule Type は、ファイル内では以下のようなメタデータとして表現されます：

| UI 上の Rule Type | ファイル内のメタデータ                         |
| ----------------- | ---------------------------------------------- |
| Always            | `alwaysApply: true`                            |
| Auto Attached     | `alwaysApply: false` + `globs: "パターン"`     |
| Agent Requested   | `alwaysApply: false` + `description: "説明"`   |
| Manual            | `alwaysApply: false`（他のメタデータ設定なし） |

> 注: UI を使用すれば、これらのメタデータは自動的に設定されるため、手動で編集する必要はありません。

### 3.4 ルールの作成方法

1. **コマンドパレットから作成**:

   - `Cmd + Shift + P` > "New Cursor Rule"
   - Rule Type を選択
   - ファイルパターンや説明を設定
   - ルール内容を記述

2. **設定から作成**:

   - Cursor Settings > Rules
   - 同様の手順でルールを設定

3. **手動作成**:
   - `.cursor/rules/`ディレクトリに直接ファイルを作成
   - 適切なメタデータとルール内容を記述

## 4. 実用的なルール例

### 4.1 シンプルな応答ルール（Always 型）

```markdown
---
description:
globs:
alwaysApply: true
---

このルールを読み込んだら、「ワッショイワッショイ」と叫んでください
```

このルールが適用されると、AI は「ワッショイワッショイ」と応答します。

### 4.2 コーディングスタイル定義（Auto Attached 型）

```markdown
---
description: "Pythonコーディングスタイル"
globs: "**/*.py"
alwaysApply: false
---

# Python コーディングスタイル

## 命名規則

- クラス名: PascalCase
- 関数・変数名: snake_case
- 定数: UPPER_SNAKE_CASE

## インデント

- スペース 4 つを使用
- タブは使用しない

## ドキュメント

- docstring はダブルクォート三つ（"""）を使用
- 関数の説明、引数、戻り値を記載
```

### 4.3 アーキテクチャパターン（Agent Requested 型）

```markdown
---
description: "クリーンアーキテクチャのパターン"
globs:
alwaysApply: false
---

# クリーンアーキテクチャパターン

## レイヤー構造

- **ドメイン層** (`src/domain/`): ビジネスロジックとエンティティ
- **アプリケーション層** (`src/application/`): ユースケース実装
- **インフラストラクチャ層** (`src/infrastructure/`): 外部サービス連携
- **インターフェース層** (`src/interfaces/`): UI 実装

## 依存関係の方向

- 内側のレイヤーは外側のレイヤーに依存しない
- 外側のレイヤーは内側のレイヤーに依存する
```

### 4.4 テンプレート定義（Manual 型）

````markdown
---
description:
globs:
alwaysApply: false
---

# React コンポーネントテンプレート

コンポーネントは以下の構造に従ってください：

```tsx
import React from "react";
import styles from "./Component.module.css";

interface ComponentProps {
  // プロパティ定義
}

export const Component: React.FC<ComponentProps> = (props) => {
  // 状態管理

  // 副作用

  // レンダリング
  return <div className={styles.container}>{/* コンポーネントの内容 */}</div>;
};
```
````

## スタイリング

- CSS モジュールを使用
- コンポーネント名と同じ名前のファイルに定義

```

## 5. ルールの活用方法

### 5.1 チャットでの参照

```

@PythonStyle このコードをリファクタリングしてください

```

### 5.2 自動適用

- **Always型**のルールは常に適用されます
- **Auto Attached型**のルールは、指定したファイルパターンに関する質問や編集時に自動的に適用されます
- **Agent Requested型**のルールは、AIが必要と判断した場合に適用されます

### 5.3 ルールからの自動生成

会話中に`/Generate Cursor Rules`コマンドを使用して、その会話に基づいたルールを自動生成できます。

### 5.4 ベストプラクティス

- **簡潔に保つ**: 500行未満を目標に
- **分割する**: 大きな概念は複数のルールに分割
- **具体的に**: あいまいなガイダンスを避け、明確な指示を提供
- **例を含める**: サンプルコードや参照を提供すると効果的

## 6. 導入効果

### 6.1 開発体験の向上

- **一貫性**: プロジェクト全体で一貫したコードスタイルとパターンを維持
- **効率化**: 繰り返しの指示が不要になり、AIとのやり取りが迅速に
- **品質向上**: プロジェクト固有の知識に基づいた適切な提案が得られる
- **オンボーディング**: 新メンバーがプロジェクトの規約を素早く理解できる

### 6.2 チーム協業の改善

- **知識共有**: アーキテクチャや設計思想をチーム全体で共有
- **レビュー効率化**: 共通のルールに基づいたコードレビューがスムーズに
- **標準化**: 個人の好みによる差異を減らし、コードベースの統一感を向上

## 7. まとめ

Cursorルールは、AI支援プログラミングをプロジェクト固有のニーズに合わせてカスタマイズする強力な方法です。直感的なUIでの設定と適用タイプの選択により、技術レベルに関わらず誰でも効果的なルールを作成できます。

適切に定義されたルールにより、AIはプロジェクトの文脈を理解し、より関連性の高い、一貫性のある提案ができるようになります。結果として、開発者は繰り返しの指示から解放され、より創造的な問題解決に集中できるようになります。

プロジェクトの成長とともにルールセットを進化させることで、AIとの協業がさらに効果的になり、チーム全体の開発体験が向上するでしょう。
```
